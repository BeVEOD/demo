<%;################################################
## This file and all its content belong to Faveod S.A.S unless a commercial
## contract signed by a representant of Faveod S.A.S states otherwise.
##########
# THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
# EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
# MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
# NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
# LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
# OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
# WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
################################################
## This has been generated by Faveod Generator on Thu Oct 31 16:38:16 +0100 2013
## It should be placed at 'app/views/file_imports/_result_list.html.erb'
## All manual modifications will be destroyed on next generation
################################################ %>
<% @file_imports ||= file_imports
if @file_imports.blank? %>
<%= _('No entry match criteria') %>
<% else %>
<%= _("%{count} Results:") % {:count => @file_imports.total_entries} %><br />
<% my_params = params; num = params[:smart_query] ? params[:smart_query].first.first : nil
 my_params[:smart_query][num][:criteria] =
   params[:smart_query][num][:criteria].reject{|k,v|
     v.is_a?(Hash) && v.values.any?(&:blank?)} if num %>
<%= link_to(image_tag('page_icons/page_white_excel.png') +' '+ _("Download as CSV"),   url_for(my_params.merge(:format => :csv))) %>
<%= link_to(image_tag('page_icons/page_white_excel.png') +' '+ _("Download as Excel"), url_for(my_params.merge(:format => :xls))) %>
<%= link_to(image_tag('page_icons/page_white_code.png')  +' '+ _("Download as XML"),   url_for(my_params.merge(:format => :xml))) %>

<%= will_paginate(@file_imports, :class => 'pagination ajax', :params => my_params.reject{|k,v| k.to_s == 'page'},
	:previous_label => image_tag("/images/std/go_left.png",  :title => _('Previous Page'),  :alt => _('Go Left') ),
	:next_label     => image_tag("/images/std/go_right.png", :title => _('Next Page'),	:alt => _('Go Right') )) %>
<table class="sortable" id="file_imports_table" summary="file_imports list"><thead>
<tr class="containers"><th colspan="4"><%= _(%q{Import}) %></th><th colspan="6"><%= _(%q{Progress}) %></th><th colspan="1"><%= _(%q{Log}) %></th><th class="no-sort" rowspan="2"></th></tr>
<tr><th id="file_imports_user_th"><%= _(%q{User}) %></th><th id="file_imports_file_th"><%= _(%q{File}) %></th><th id="file_imports_file_import_th"><%= _(%q{File Import}) %></th><th id="file_imports_re_imports_th"><%= _(%q{Re-imports}) %></th><th id="file_imports_started_at_th"><%= _(%q{Started at}) %></th><th id="file_imports_completed_at_th"><%= _(%q{Completed at}) %></th><th id="file_imports_read_lines_th"><%= _(%q{Read lines}) %></th><th id="file_imports_wrote_records_th"><%= _(%q{Wrote Records}) %></th><th id="file_imports_expected_total_th"><%= _(%q{Expected total}) %></th><th id="file_imports_error_count_th"><%= _(%q{Error Count}) %></th><th id="file_imports_log_th"><%= _(%q{Log}) %></th></tr>
</thead>

<tbody><% @file_imports.each_with_index do |row,idx|
@file_import = row %>

		<tr class="<%= (idx % 2 == 1) ? 'odd' : 'even' %>" id="file_imports_<%= @file_import.try(:id) %>" >
<td><span class="aligned"><%=  link_to(@file_import.user.disp_name, {:controller => :users, :action => :show, :id => @file_import.user.id}) unless @file_import.user.blank? %></span></td>
<td><span class="aligned color"><% unless @file_import.file__name.blank? %><a href="<%= "/#{params[:lang]}" if params[:lang] %>/file_imports/get_file/<%= @file_import.id %>?sid=file" data-method="get" rel="nofollow" title="<%= _(%q{Load the entire file.}) %>"><%= @file_import.file__name %></a><% end %></span></td>
<td><span class="aligned"><%=  link_to(@file_import.file_import.disp_name, {:controller => :file_imports, :action => :show, :id => @file_import.file_import.id}) unless @file_import.file_import.blank? %></span></td>
<td><span class="aligned"><%=  @file_import.re_imports[0..20].compact.map{|v| link_to(v.disp_name, {:controller => :file_imports, :action => :show, :id => v.id}) }.to_sentence.html_safe  %></span></td>
<td><span class="aligned"><%= h @file_import.started_at %></span></td>
<td><span class="aligned"><%= h @file_import.completed_at %></span></td>
<td><span class="aligned"><%= h @file_import.read_lines %></span></td>
<td><span class="aligned"><%= h @file_import.wrote_records %></span></td>
<td><span class="aligned"><%= h @file_import.expected_total %></span></td>
<td><span class="aligned"><%= h @file_import.error_count %></span></td>
<td><span class="aligned"><%=  txt= @file_import.log; h(txt.to(100)) + (txt.length > 100 ? '...' : '') unless txt.blank? %></span></td>
<td class="std_links"><%= links_for_list_element(@file_import) %></td>
</tr>
<% end %></tbody></table>
<% end %>


<script type="text/javascript">
//<![CDATA[





function onload_result_list_call() {

$('.pagination.ajax a').click(function(evt) {
    $('#search_results').load(elt.href, {method: 'get', asynchronous:true, evalScripts:true})
    evt.stop()
})

}
<% if request.xhr? %>onload_result_list_call();<% else %>if (typeof(Event) != 'undefined' && Event.observe) {
Event.observe(window, 'load', onload_result_list_call)
} else if (typeof(jQuery) != 'undefined') {
$(window).load(onload_result_list_call)
}<% end %>


//]]>
</script>