<%;################################################
## This file and all its content belong to Faveod S.A.S unless a commercial
## contract signed by a representant of Faveod S.A.S states otherwise.
##########
# THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
# EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
# MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
# NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
# LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
# OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
# WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
################################################
## This has been generated by Faveod Generator on Thu Oct 31 16:38:07 +0100 2013
## It should be placed at 'app/views/system_settings/sql_console.html.erb'
## All manual modifications will be destroyed on next generation
################################################ %>
<div id="terminal" style="overflow-y:visible"></div>
<script type="text/javascript" src="/javascripts/jquery.mousewheel.js"></script>
<script type="text/javascript" src="/javascripts/jquery.terminal.min.js"></script>
 
<script type="text/javascript">
//<![CDATA[

(function() {
    var lnk = document.createElement("link");
    lnk.setAttribute("media","all");
    lnk.setAttribute("type","text/css");
    lnk.setAttribute("rel","stylesheet");
    lnk.setAttribute("href", "/stylesheets/jquery.terminal.css");
    document.getElementsByTagName("head")[0].appendChild(lnk);
})();



function onready_sql_console_call() {

  $('#terminal').css('height', ($(window).height() - $('#header').height() - 25) + 'px');

  $("#terminal").terminal((function(cmd, term) {
    var req = $.ajax({ data: {query: cmd}, type: "POST", url: "" });
    req.done(function(res, textStatus, jqXHR) {
      term.echo(res.columns.join(' | '));
      return $.each(res.rows, function(i, row) {
        return term.echo(row.join(' | '));
      });
    });
    return req.fail(function(jqXHR, textStatus, errorThrown) {
      return term.echo("[[g;#f00;#000]" + jqXHR.responseText + "]");
    });
  }), {
    greetings: new Date,
    prompt: 'sql> '
  });


}
<% if request.xhr? %>onready_sql_console_call();<% else %> if (document.observe) {
document.observe('dom:loaded', onready_sql_console_call)
} else if (typeof(jQuery) != 'undefined') {
jQuery(document).ready(onready_sql_console_call)
}<% end %>




//]]>
</script>