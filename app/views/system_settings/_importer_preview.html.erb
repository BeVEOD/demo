<%;################################################
## This file and all its content belong to Faveod S.A.S unless a commercial
## contract signed by a representant of Faveod S.A.S states otherwise.
##########
# THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
# EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
# MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
# NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
# LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
# OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
# WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
################################################
## This has been generated by Faveod Generator on Tue May 11 13:10:42 +0200 2010
## It should be placed at 'app/views/system_settings/_importer_preview.html.erb'
## All manual modifications will be destroyed on next generation
################################################ 
%><% if @file %>


<%= submit_to_remote('Submit', _("Create Only"), {
  :url => {:action => :importer, :command => "create_only"},
  :before => "$$('.command_button').map(function (x) {x.disable()}); $('importer_loading').show(); $('darken').show();",
  :class => 'command_button'
}) %>

<%= submit_to_remote('Submit', _("Update Only"), {
  :url => {:action => :importer, :command => "update_only"},
  :before => "$$('.command_button').map(function (x) {x.disable()}); $('importer_loading').show(); $('darken').show();",
  :class => 'command_button'
}) %>


<fieldset><legend><%= _(%q{Preview}) %></legend>
<p class="help">
<%= _(%q{Match the columns in your files to the column in your database.}) %><br />
<%= _(%q{If you choose to update records, tick the 'Find Key' box under the columns used to find the appropriate record based on these values.}) %>
<%= _(%q{The other columns will override existing values in the other fields from the matching records.}) %>
</p>

<%= content_tag(:div, @msg[:preview], :class => 'notice') if @msg[:preview] %>

<div style="width:900px;overflow-x:scroll;overflow-y:hidden" id="import_result_div">
<table>
<tr><th><%= _(%q{Match}) %></th><% @columns.size.times  do|i| -%><th><%= select_tag("match[#{i}]", options_for_select(@fields.map{|n,s| [_(n), s]}, @matches[i]), :class => 'field_options') %></th><% end -%></tr>
<tr><th><%= _(%q{Find Key}) %></th><% @columns.size.times  do|i| -%><th><%= check_box_tag("find_key[#{i}]", '1', @find_keys[i], :class => 'field_options') %></th><% end -%></tr>
<% if !@columns.blank? %>
<tr><th><%= _(%q{Skip}) %></th><%= @columns.map{|c| content_tag(:th, c)}.join %></tr>
<% end %>

<% @data.each do |row| %><tr id="system_setting_preview_<%= row[:index] %>">
  <td><%= check_box_tag("skip[#{row[:index]}]", '1', row[:meta][:skip], :title => _('Skip')) %></td>
  <%= row[:data].map{|f|content_tag(:td, f)}.join %></tr>
<% end %>
</table></div>
</fieldset>

<% end %>
<script type="text/javascript">
if ($('import_result_div')) {$('import_result_div').setStyle('width:'+document.viewport.getWidth()-16+'px')}
</script>
